"use strict";(self.webpackChunkstephanie_solution=self.webpackChunkstephanie_solution||[]).push([[7719,2539],{7719:(l,e,i)=>{i.d(e,{Z:()=>j});var s=i(2791),t=i(9760),a=i(2647),d=i(2350),n=i(5232),o=i(1439),r=i(254),v=i(2539),c=i(9138),u=i(7984),m=i(15),p=i(184);const h=(0,a.Np)(),x=(0,a.pz)(),b=((0,a.PU)(),(0,a.tW)()),f=(0,a.YZ)(),N="add_passportRecord",g=l=>{let{frmNm3:e,updObs:i}=l;return(0,p.jsxs)("div",{children:[(0,p.jsx)(v.SO,{title:"Passport Number:",frmNm:e,keyfld:"passportNumber",updObs:i}),(0,p.jsx)(v.SO,{title:"Country:",frmNm:e,keyfld:"countryOfIssuance",updObs:i}),(0,p.jsx)(v.Fm,{title:"Expiration Date:",frmNm:e,keyfld:"expirationDate",updObs:i}),(0,p.jsx)(v.Fm,{title:"Issue Date:",frmNm:e,keyfld:"issueDate",updObs:i}),(0,p.jsx)(v.Fm,{title:"Date of Birth:",frmNm:e,keyfld:"dob",updObs:i}),(0,p.jsx)(v.SO,{title:"Name:",frmNm:e,keyfld:"name1",updObs:i}),(0,p.jsx)(v.SO,{title:"Name:",frmNm:e,keyfld:"name2",updObs:i}),(0,p.jsx)(v.SO,{title:"Name:",frmNm:e,keyfld:"name3",updObs:i}),(0,p.jsx)(v.SO,{title:"Name:",frmNm:e,keyfld:"name4",updObs:i})]})},_=l=>{var e,i,t,a,r,v,x,N,g;let{frmNm3:_,updObs:j,handleSubmit:k,image:R,item:O}=l;const D=(0,s.useRef)(null),[,C]=(0,s.useState)(1),[M,S]=(0,s.useState)(0),[T,z]=(0,s.useState)(0),[E,F]=(0,s.useState)(0),I=(0,s.useRef)("");let Z=(0,d.bh)("mrzObj");const W=l=>{if(l){let e=y(l);(0,d.Rz)(_,e),B(e.passportNumber,e.expirationDate,e.dob),j(),F(0),setTimeout((()=>{j()}),600)}},B=async(l,e,i)=>{var s;let t={...null===(s=(0,d.bh)((0,d.hQ)()))||void 0===s?void 0:s.search_notary};t.params={":search0":l,":search1":e,":search2":i};const a=(0,d.I7)(t),n=await a;n&&(0,d._2)(n).length>1?(console.log("client found with this passport"),(0,m.OpenToast)({text:"Cliente encontrado con este pasaporte",timeout:4500})):j()},L=async l=>{let e=await(0,n.ln)(l);W(e)},H=async(l,e)=>{let i=await(0,n.x4)(l.type,e),s=(await(0,n.Dr)(i,l),(0,d.LH)(e));var t=await(0,n.v8)(e);let a={fileName:e,blob:await(0,d.Em)(t.url,s),s3Path:null===t||void 0===t?void 0:t.s3Path};(0,d.Rz)("mrzObj",a),z(0)};return(0,p.jsxs)("div",{className:" spaceAround flxWrp",style:{paddingTop:"35px"},children:[null!==Z&&void 0!==Z&&Z.blob?(0,p.jsx)("img",{src:null===Z||void 0===Z?void 0:Z.blob,alt:"mrz"}):null,(0,p.jsxs)("div",{className:"",style:{padding:"15px"},children:[(0,p.jsx)(h,{init:null===(e=(0,d.bh)(_))||void 0===e?void 0:e.MRZ_1,width:450,updChanges:l=>j("MRZ_1",l)}),(0,p.jsxs)("span",{children:[" ",null===(i=(0,d.bh)(_))||void 0===i||null===(t=i.MRZ_1)||void 0===t?void 0:t.length,"/44 "]})]}),(0,p.jsxs)("div",{className:"",style:{padding:"15px"},children:[(0,p.jsx)(h,{init:null===(a=(0,d.bh)(_))||void 0===a?void 0:a.MRZ_2,width:450,updChanges:l=>j("MRZ_2",l)}),(0,p.jsxs)("span",{children:[" ",null===(r=(0,d.bh)(_))||void 0===r||null===(v=r.MRZ_2)||void 0===v?void 0:v.length,"/44 "]})]}),(0,p.jsxs)("div",{className:"_dsplFlx spaceAround flxWrp ",style:{padding:9},children:[null!==(x=(0,d.bh)(_))&&void 0!==x&&x.MRZ_2||null===Z||void 0===Z||!Z.blob?null:(0,p.jsx)("div",{className:"_dsplFlx spaceAround flxWrp",children:E?(0,p.jsx)(o.N,{inner:(0,p.jsx)(b,{stroke:"var(--partial-success)",size:24,strokeW:8}),color:"#feb200",label:"reading ..."}):(0,p.jsx)(o.N,{icon:"image_outline",color:"#feb200",label:"Read MRZ Image",clickHandler:async()=>{F(1);let l=null===Z||void 0===Z?void 0:Z.s3Path,e=await(0,n.DO)(l+".json");if(e){var i=await fetch(e);if(200===i.status){var s=await i.json();null!==s&&void 0!==s&&s.Blocks?W(s):L(l)}else L(l)}else L(l)}})}),(0,p.jsx)("div",{className:"_dsplFlx spaceAround flxWrp",children:(0,p.jsx)(o.N,{color:"#007bfc",label:"Read MRZ",clickHandler:l=>{if(l){let{MRZ_1:l,MRZ_2:e}=(0,d.bh)(_);let i=w([l,e]);(0,d.Rz)(_,i),B(i.passportNumber,i.expirationDate,i.dob),j(),F(0),setTimeout((()=>{j()}),600)}}})})]}),(0,p.jsx)("div",{style:{paddingTop:"35px"}}),null!==(N=(0,d.bh)(_))&&void 0!==N&&N.MRZ_2?null:(0,p.jsxs)("div",{className:"_dsplFlx ",style:{marginTop:20},children:[(0,p.jsx)(f,{initvalue:M,keyCode:57,updChange:S,color:"#007bfc"}),(0,p.jsx)("span",{className:"checklabel",children:"Show Crop MRZ"})]}),null!==(g=(0,d.bh)(_))&&void 0!==g&&g.MRZ_2||!M?null:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"_dsplFlx spaceAround flxWrp",children:T?(0,p.jsx)(o.N,{inner:(0,p.jsx)(b,{stroke:"var(--partial-success)",size:24,strokeW:8}),color:"#feb200",label:I.current}):(0,p.jsx)(o.N,{color:"#007bfc",label:"Crop MRZ",clickHandler:async()=>{var l,e,i;I.current="Cropping ...",z(1);let s=null===(l=(0,d.bh)(_))||void 0===l||null===(e=l.MRZ_1Line)||void 0===e||null===(i=e.Geometry)||void 0===i?void 0:i.BoundingBox,t=O.fileName.split(".").pop(),a=O.fileName.split("."+t)[0]+"_mrz."+t,n=(0,d.bh)("preview_dmz"),o=(null===s||void 0===s?void 0:s.Height)*n.h,r=(null===s||void 0===s?void 0:s.Width)*n.w,v=(null===s||void 0===s?void 0:s.Left)*n.w,c={height:3*o,width:r+60,top:(null===s||void 0===s?void 0:s.Top)*n.h-10,left:v-30};D.current.setCoordinates(c),setTimeout((()=>{I.current="Uploading ...",C((0,d.M5)()),(async l=>{var e=(0,d.bh)("dajsdansdar").toDataURL(),i=await(0,d.Mi)(e,"image/png");const s=await(0,u.Z)(i,{maxSizeMB:1,maxWidthOrHeight:1920});H(s,l)})(a)}),650)}})}),(0,p.jsx)("div",{style:{paddingTop:"35px"}}),(0,p.jsxs)("div",{style:{position:"relative"},children:[T?(0,p.jsx)("div",{className:"loading_overlay_passport",children:(0,p.jsx)("div",{className:"loading_app centerBx",children:(0,p.jsxs)("div",{className:"icon_compr _dsplFlx",children:[(0,p.jsx)("div",{className:"lbl_saving ",children:"Uploading the image ..."}),(0,p.jsx)(b,{stroke:"var(--partial-success)",size:24,strokeW:8})]})})}):null,(0,p.jsx)("div",{className:"cropper_container",children:(0,p.jsx)(c.fle,{src:R,onChange:l=>{let e=l.getCanvas();(0,d.Rz)("dajsdansdar",e)},className:"cropper",ref:D,defaultSize:l=>{let{imageSize:e,visibleArea:i}=l;return{width:.95*(i||e).width,height:.95*(i||e).height}}})})]})]}),(0,p.jsx)("div",{style:{paddingTop:"35px"}})]})},j=l=>{let{frmNm3:e,updObs:i,updFrm:a,item:v,image:c,confirm:u,action:m,close:h}=l;const[,f]=(0,s.useState)(1),[j,w]=(0,s.useState)(!1),[k,R]=(0,s.useState)(!1),O=l=>{if(null!==l&&void 0!==l&&l.IdentityDocuments){let s=y(null===l||void 0===l?void 0:l.IdentityDocuments[0]);(0,d.Rz)(e,s),i()}},D=async l=>{let e=await(0,n.IH)(l);O(e),T(null===e||void 0===e?void 0:e.IdentityDocuments[0])},C=async l=>{let e=await(0,n.DO)(l+"_idDoc.json");if(e){var i=await fetch(e);if(200===i.status){var s=await i.json();null!==s&&void 0!==s&&s.IdentityDocuments?(O(s),T(null===s||void 0===s?void 0:s.IdentityDocuments[0])):D(l)}else D(l)}else D(l)},M=async l=>{var e;let i={...null===(e=(0,d.bh)((0,d.hQ)()))||void 0===e?void 0:e.search_notary};i.params={":search0":l.passportNumber,":search1":l.expirationDate,":search2":l.dob};const s=(0,d.I7)(i),a=await s;a&&(0,d._2)(a).length>1?(console.log("client found with this passport"),S(l)):(u(l),(0,t.CloseModal)({id:v.modalId}))},S=l=>{let e=(0,d.bh)("lastTimeCallModal")||0;if(Date.now()>e){(0,d.Rz)("lastTimeCallModal",Date.now()+320);let e={zIndex:950,height:"40vh",props:{minHeight:"1vh",overlay:!0,closeEvent:()=>{}}};e.content=(0,p.jsx)(x,{confirm:()=>(l=>{u(l),(0,t.CloseModal)({id:v.modalId})})(l),color:"#007bfc",lbl_p:"Cliente encontrado",lbl_confirm:"Guardar",lbl_span:"Encontramos un cliente con la informacion de este pasaporte",lbl_span2:"Deseas agregarlo de nuevo ???"}),(0,t.OpenModal)(e)}},T=l=>{var e,s,t;null!==l&&void 0!==l&&l.Blocks&&(null!==l&&void 0!==l&&null!==(e=l.error)&&void 0!==e&&e.message?(R(null===l||void 0===l||null===(t=l.error)||void 0===t?void 0:t.message),w(!1)):(null===l||void 0===l||null===(s=l.Blocks)||void 0===s?void 0:s.length)>0?((0,d.Rz)("image_text",null===l||void 0===l?void 0:l.Blocks),R(""),w(!1)):(R("No se pudo leer la imagen intentelo de nuevo"),w(!1)));(0,d.Rz)("loading_image_text",!1),i()};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"_dsplFlx ",style:{padding:9,width:"100%"},children:[j?(0,p.jsxs)("div",{className:"icon_compr _dsplFlx",children:[(0,p.jsx)("div",{className:"lbl_saving ",children:"Trying to read the image ..."}),(0,p.jsx)(b,{stroke:"var(--partial-success)",size:24,strokeW:8})]}):(0,p.jsxs)("div",{className:"_dsplFlx",children:[(0,p.jsx)(o.N,{color:"#007bfc",label:"Redraw form",clickHandler:()=>(l=>{w(!0),R("");let e=(null===v||void 0===v?void 0:v.s3Path)||(null===v||void 0===v?void 0:v.fileName);(0,d.CO)(e)&&C(e)})()}),k?(0,p.jsx)("div",{className:"msg_alert red",children:(0,p.jsx)("div",{className:"msg_alert_title",children:k})}):null]}),(0,p.jsx)("div",{className:"flexSpace"}),(0,p.jsx)("div",{className:"",children:(0,p.jsx)(o.N,{color:"#007bfc",label:"Save",clickHandler:()=>{let l={...(0,d.bh)(N)},i=Object.assign({},l);(0,d._2)((0,d.bh)(e)).map((l=>{(0,d.UE)((0,d.bh)(e)[l])&&(i[l]=(0,d.bh)(e)[l])})),i.clientNotaryId=(0,d.M5)(),i.passportImage=null===v||void 0===v?void 0:v.fileName,i.passportTempImageCluster=null===v||void 0===v?void 0:v.clientNotaryId,(0,d.Rz)(N,i),M(i)}})})]}),(0,p.jsx)(g,{frmNm3:e,updObs:i}),(0,p.jsx)(_,{frmNm3:e,updObs:a,handleSubmit:()=>{var l,i,s,t;let a=(0,d.bh)(e)||{};const o=[null===a||void 0===a?void 0:a.MRZ_1,null===a||void 0===a?void 0:a.MRZ_2];var v=(0,r.Qc)(o),c=null===v||void 0===v?void 0:v.fields;a.cid=null===c||void 0===c?void 0:c.personalNumber,a.genre=(0,d.kC)(null===c||void 0===c?void 0:c.sex),a.lastName=null===c||void 0===c?void 0:c.lastName,a.firstName=null===c||void 0===c?void 0:c.firstName,a.name3=null===c||void 0===c?void 0:c.firstName,a.name1=null===c||void 0===c||null===(l=c.lastName)||void 0===l||null===(i=l.split(" "))||void 0===i?void 0:i[0],a.name2=null===c||void 0===c||null===(s=c.lastName)||void 0===s||null===(t=s.split(" "))||void 0===t?void 0:t[1],a.passportNumber=null===c||void 0===c?void 0:c.documentNumber;let u=(0,n.a_)(null===c||void 0===c?void 0:c.birthDate,1);a.dob=u.getTime();let m=(0,n.a_)(null===c||void 0===c?void 0:c.expirationDate,0);a.expirationDate=m.getTime();let p=new Date(m);p.setFullYear(p.getFullYear()-6),a.issueDate=p.getTime(),a.documentCode=null===c||void 0===c?void 0:c.documentCode,a.countryOfIssuance=null===c||void 0===c?void 0:c.issuingState,a.mrz=o,(0,d.Rz)(e,a),f((0,d.M5)())},image:c,item:v})]})},y=l=>{var e;let i="",s="",t={};if(null===l||void 0===l||null===(e=l.Blocks)||void 0===e||e.map((l=>{let{BlockType:e,Text:a}=l;"LINE"===e&&a.indexOf("<")>=0&&(a.indexOf("P<")>=0?(i=a,t.MRZ_1=a,t.MRZ_1Line=l):(s=a,t.MRZ_2=a))})),44===i.length&&44===s.length){return w([i,s])}return t},w=l=>{var e,i,s,t;let a={};var o=(0,r.Qc)(l),v=null===o||void 0===o?void 0:o.fields;a.cid=null===v||void 0===v?void 0:v.personalNumber,a.genre=(0,d.kC)(null===v||void 0===v?void 0:v.sex),a.lastName=null===v||void 0===v?void 0:v.lastName,a.firstName=null===v||void 0===v?void 0:v.firstName,a.name3=null===v||void 0===v?void 0:v.firstName,a.name1=null===v||void 0===v||null===(e=v.lastName)||void 0===e||null===(i=e.split(" "))||void 0===i?void 0:i[0],a.name2=null===v||void 0===v||null===(s=v.lastName)||void 0===s||null===(t=s.split(" "))||void 0===t?void 0:t[1],a.passportNumber=null===v||void 0===v?void 0:v.documentNumber;let c=(0,n.a_)(null===v||void 0===v?void 0:v.birthDate,1);a.dob=c.getTime();let u=(0,n.a_)(null===v||void 0===v?void 0:v.expirationDate,0);a.expirationDate=u.getTime();let m=new Date(u);return m.setFullYear(m.getFullYear()-6),a.issueDate=m.getTime(),a.documentCode=null===v||void 0===v?void 0:v.documentCode,a.countryOfIssuance=null===v||void 0===v?void 0:v.issuingState,a.MRZ_1=l[0],a.MRZ_2=l[1],a.mrz=l,a}},2539:(l,e,i)=>{i.d(e,{Fm:()=>u,NV:()=>m,SO:()=>c,he:()=>p,pl:()=>r});var s=i(2791),t=i(2647),a=i(2350),d=i(184);const n=(0,t.Np)(),o=((0,t.tW)(),(0,t.PU)()),r=l=>{let{image:e,dmz:i}=l,s=i||(0,a.bh)("preview_dmz"),{KEY_VALUE_SET:t,WORD:n,LINE:o}=h((0,a.bh)("image_text"));return(0,d.jsxs)("svg",{id:"ssg_business_card_front",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 ".concat(null===s||void 0===s?void 0:s.w," ").concat(null===s||void 0===s?void 0:s.h),preserveAspectRatio:"xMidYMid meet",children:[(0,d.jsx)("style",{type:"text/css",children:'@font-face {\n\t\t\t\tfont-family: "Google Sans";\n\t\t\t\tsrc: url(http://fonts.gstatic.com/s/googlesans/v14/4UabrENHsxJlGDuGo1OIlLU94YtzCwY.woff2)\n\n\t\t\t}'}),(0,d.jsx)("rect",{width:null===s||void 0===s?void 0:s.w,height:null===s||void 0===s?void 0:s.h,fill:"#ffffff"}),(0,d.jsx)("image",{width:null===s||void 0===s?void 0:s.w,height:null===s||void 0===s?void 0:s.h,x:0,y:0,xmlnsXlink:"http://www.w3.org/1999/xlink",xlinkHref:e}),null===t||void 0===t?void 0:t.map(((l,e)=>(0,d.jsx)(v,{idKey:e+"_tann",item:l,index:e},e+"_tann"))),null===o||void 0===o?void 0:o.map(((l,e)=>(0,d.jsx)(v,{idKey:e+"_tann",item:l,index:e},e+"_tann")))]})},v=l=>{let{item:e,index:i,idKey:s}=l;const{Text:t,Geometry:n,boundingPoly:o,BlockType:r,Id:v}=e;let c="transparent";if("PAGE"===r)return null;var u;("LINE"===r&&(c="rgba(168, 199, 250,1)"),"KEY_VALUE_SET"===r)&&(c="KEY"===(null===e||void 0===e||null===(u=e.EntityTypes)||void 0===u?void 0:u[0])?"#BB021E":"#8110F1");if("WORD"===r)return null;"WORD"===r&&(c="#646cff",c="#8b949e");let m=null===o||void 0===o?void 0:o.vertices,p=t,h=n.BoundingBox,x=(0,a.bh)("preview_dmz"),b=(null===h||void 0===h?void 0:h.Height)*x.h,f=(null===h||void 0===h?void 0:h.Width)*x.w,N=(null===h||void 0===h?void 0:h.Left)*x.w,g=(null===h||void 0===h?void 0:h.Top)*x.h;return 0===i||null===m||void 0===m||m[1],(0,d.jsxs)(d.Fragment,{children:[null,(0,d.jsx)("rect",{onClick:l=>{l.stopPropagation(),l.preventDefault(),(0,a.vQ)(p)},onContextMenu:l=>{l.stopPropagation(),l.preventDefault()},width:f,height:b,fill:c,fillOpacity:"50%",x:N,y:g})]})},c=l=>{var e;let{title:i,keyfld:t,updObs:r,frmNm:v}=l;const[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(1),h=()=>{r&&r(),u(!1)};let x=null===(e=(0,a.bh)(v))||void 0===e?void 0:e[t];return(0,d.jsxs)("div",{className:"_dsplFlx dtls",children:[(0,d.jsx)("div",{className:"lbl_h_dtls",style:{marginTop:c?8:1},children:i}),c?(0,d.jsxs)("div",{className:"_dsplFlx",children:[(0,d.jsx)("div",{className:"lbl_dtls",children:(0,d.jsx)(n,{init:x,width:240,updChanges:l=>((l,e)=>{let i=(0,a.bh)(v)||{};i[l]=e,(0,a.Rz)(v,i),p((0,a.M5)())})(t,l),onEnter:h})}),(0,d.jsx)("div",{className:"icon_image ",onClick:h,children:(0,d.jsx)(o,{name:"success",color:"var(--success)"})})]}):(0,d.jsx)("div",{className:"lbl_dtls",onClick:()=>u(!0),children:x||"click to type"})]})},u=l=>{var e,i;let{title:t,keyfld:r,updObs:v,frmNm:c}=l;const[u,m]=(0,s.useState)(!1),[p,h]=(0,s.useState)(1),[x,b]=(0,s.useState)(""),f=()=>{((l,e)=>{let i=(0,a.bh)(c)||{},s=new Date(e).getTime();i[l]=s,(0,a.Rz)(c,i),h((0,a.M5)())})(r,x),v&&v(),m(!1)};let N=null===(e=(0,a.bh)(c))||void 0===e?void 0:e[r],g=x||(0,a.sJ)(null===(i=(0,a.bh)(c))||void 0===i?void 0:i[r])||"";return(0,d.jsxs)("div",{className:"_dsplFlx dtls",children:[(0,d.jsx)("div",{className:"lbl_h_dtls",style:{marginTop:u?8:1},children:t}),u?(0,d.jsxs)("div",{className:"_dsplFlx",children:[(0,d.jsx)("div",{className:"lbl_dtls",children:(0,d.jsx)(n,{init:g,width:240,updChanges:b,onEnter:f})}),(0,d.jsx)("div",{className:"icon_image ",onClick:f,children:(0,d.jsx)(o,{name:"success",color:"var(--success)"})})]}):(0,d.jsx)("div",{className:"lbl_dtls",onClick:()=>m(!0),children:(0,a.sG)(N)||"click to type"})]})},m=l=>{let{label:e,value:i}=l;return i?"object"===typeof i?null:(0,d.jsxs)("div",{className:"_dsplFlx dtls",children:[(0,d.jsx)("div",{className:"lbl_h_dtls",children:e}),(0,d.jsx)("div",{className:"lbl_dtls",onClick:()=>{return l=i,void(0,a.vQ)(null===l||void 0===l?void 0:l.trim());var l},children:i})]}):null},p=l=>{let{label:e,value:i}=l;return i?"object"===typeof i?null:(0,d.jsxs)("div",{className:"_dsplFlx dtls",children:[(0,d.jsx)("div",{className:"lbl_h_dtls",children:e}),(0,d.jsx)("div",{className:"lbl_dtls",onClick:()=>{return l=i,void(0,a.vQ)(null===l||void 0===l?void 0:l.trim());var l},children:"*******"})]}):null},h=l=>{let e=[],i=[],s=[];return null===l||void 0===l||l.map((l=>{let{BlockType:t}=l;"WORD"===t&&i.push(l),"LINE"===t&&s.push(l),"KEY_VALUE_SET"===t&&e.push(l)})),{KEY_VALUE_SET:e,WORD:i,LINE:s}}}}]);
//# sourceMappingURL=7719.7625cb7d.chunk.js.map