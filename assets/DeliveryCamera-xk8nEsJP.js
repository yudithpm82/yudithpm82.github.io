import{a as p,c as K,h as U,o as V,k as X,d as i,S as $,G as ee,i as n,f as te,g as Q,t as E,j as se,z as re}from"./index-BQDq9BVx.js";import"./ButonHrm-dY04wnkc.js";import{g as b,f as ne,a as oe,q as ie}from"./Util-CG-K4aC-.js";import{H as le,a as ae}from"./html5-qrcode-scanner-Cl8XE5pu.js";import{u as ce}from"./debounces-D-57AQO1.js";import y from"./FlexSpace-Ds1B62AB.js";import{g as L}from"./globalSignal-C0bDyEQ1.js";/* empty css                 */import"./SVG-CYbWHDJe.js";import"./index-Ci0zXM0r.js";var ue=E('<div class=scanWrp><div><div class=" _dsplFlx"><h3 class="errTxt err centerBx "></h3></div><div class=" _dsplFlx"><h3 class="errTxt ybcity centerBx"></h3></div><div class=" _dsplFlx"><h3 class="errTxt centerBx"></h3></div></div><div></div><div id=qr-reader style=width:300px>'),de=E("<slot name=plans style=margin-top:35px><div>"),pe=E("<div>esta funcion es solo para dispositivos mobiles"),k;function Ce(R){p([]);const[l,a]=K({}),[q,Z]=p(""),[z,B]=p(),[M,F]=p(),[T,N]=p(""),[D,G]=p(""),[I,j]=p("");U(()=>{}),V(()=>{B(!1),k?.clear()}),X(()=>{setTimeout(()=>{J()},90)});const h=(e,o)=>{N(o),G(e),setTimeout(()=>{G("")},1300)},v=e=>{j(e),setTimeout(()=>{j("")},2e3)},H=(e,o)=>{e!==M()&&(F(e),setTimeout(()=>{F("")},3e3),Y(e))},Y=e=>{if(e||(e=q()),e=e.split("'").join("-"),Z(""),I())return;let o={timeStamp:new Date().getTime(),latitude:L?.latitude,longitude:L?.longitude,statusId:"YABA_99",userId:se?.profile?.userId},r=e.split("/");e.split("-").length>3&&(r=e.split("-").join);let t=r?.[0],c="^[A-Z]{3}[0-9]{4}-[1-9]{5}";const g=new RegExp(c);let u=t.length===13&&g.test(t),f="^[0-9]{4}-[1-9]{4}";const m=new RegExp(f);let d=t.length===9&&m.test(t),S=r.length>4&&t.length===12,s={idairguide:r?.[0],":search0":r?.[1],":search1":r?.[3]};u&&(s={idairguide:"175-2383"+t.slice(3,7),":search0":t}),d&&(s={idairguide:"175-2383"+t.slice(0,4),":search0":t}),u||S||d?W(s,o):(h("","error"),a({consigneeInfo:{ybestate:"Codigo Incorrecto"}}),v(b()))},W=async(e,o)=>{let r=await ge(e),t=Object.keys(r)?.[0];r[t]?.cidentity?((r[t]?.statusHistory||[]).push(o),e.ssg_track_key=t,a(""),a(r[t]),v(b()),h("","success"),re?.roles?.[r[t]?.consigneeInfo?.ybestate]?.isActive?r[t]?.currentStatus!==o.statusId||(h("","warning"),a({consigneeInfo:{ybcity:"Fue escaneado",ybestate:r[t]?.consigneeInfo?.ybestate}}),v(b())):(h("","warning"),a({consigneeInfo:{ybestate:"Zona incorrecta"}}),v(b()))):(h("","error"),a({consigneeInfo:{ybestate:"Error con manifiesto"}}),v(b()))},J=()=>{B(!0);let e={fps:10,qrbox:{width:250,height:200},supportedScanTypes:[le.SCAN_TYPE_CAMERA],showTorchButtonIfSupported:!0,showZoomSliderIfSupported:!0,verbose:!0};k=new ae("qr-reader",e),k.render(H)};return ce(H,400),i($,{when:!0,get fallback(){return pe()},get children(){return i($,{get when(){return z()},get children(){var e=de(),o=e.firstChild;return e._$owner=ee(),n(e,i($,{get when(){return z()},style:"margin-top: 35px",get children(){var r=ue(),t=r.firstChild,c=t.firstChild,g=c.firstChild,u=c.nextSibling,f=u.firstChild,m=u.nextSibling,d=m.firstChild,S=t.nextSibling;return n(c,i(y,{}),g),n(g,D),n(c,i(y,{}),null),n(u,i(y,{}),f),n(f,()=>l?.consigneeInfo?.ybcity),n(u,i(y,{}),null),n(m,i(y,{}),d),n(d,()=>l?.consigneeInfo?.ybestate),n(m,i(y,{}),null),te(s=>{var w=`scanOverlayFront ${T()}`,x=I()?"block":"none",C=300/D()?.length*1.73+"px",_=300/l?.consigneeInfo?.ybcity?.length*1.13+"px",P=300/l?.consigneeInfo?.ybestate?.length*1.23+"px",O=`scanOverlay  ${T()} `,A=I()?"block":"none";return w!==s.e&&Q(t,s.e=w),x!==s.t&&((s.t=x)!=null?t.style.setProperty("display",x):t.style.removeProperty("display")),C!==s.a&&((s.a=C)!=null?g.style.setProperty("font-size",C):g.style.removeProperty("font-size")),_!==s.o&&((s.o=_)!=null?f.style.setProperty("font-size",_):f.style.removeProperty("font-size")),P!==s.i&&((s.i=P)!=null?d.style.setProperty("font-size",P):d.style.removeProperty("font-size")),O!==s.n&&Q(S,s.n=O),A!==s.s&&((s.s=A)!=null?S.style.setProperty("display",A):S.style.removeProperty("display")),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),r}}),o),e}})}})}const ge=async R=>{let l={params:R},a={...oe(ie())}[802001];return l={...l,...a},await ne(l)};export{Ce as default};
